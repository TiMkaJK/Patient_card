<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
    <meta charset="UTF-8">
    <title>Drugs</title>

    <link rel="stylesheet" th:href="@{/webjars/bootstrap/5.0.1/css/bootstrap.min.css}"/>
    <script th:src="@{/webjars/jquery/3.6.0/jquery.min.js/}"></script>
    <script th:src="@{/webjars/bootstrap/5.0.1/js/bootstrap.min.js}"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-
beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-
giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1"
          crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-
beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-
ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
            crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
</head>
<body>

<h1 class="mb-5 text-center" text="Drugs List"></h1>

<table id="drug-table" class="table">
    <thead class="table-dark">
    <tr>
        <th text="Name"></th>
        <th text="Manufacture Name"></th>
        <th text="Manufacture Date"></th>
        <th text="Manufacture Address"></th>
        <th text="Availability"></th>
        <th text="Contraindications"></th>
    </tr>
    </thead>
    <tbody>
    </tbody>
</table>
<nav aria-label="Page navigation example">
    <ul class="pagination">
        <li class="page-item"><a class="page-link" href="#">Previous</a></li>
        <li class="page-item"><a class="page-link" href="#">1</a></li>
        <li class="page-item"><a class="page-link" href="#">2</a></li>
        <li class="page-item"><a class="page-link" href="#">3</a></li>
        <li class="page-item"><a class="page-link" href="#">Next</a></li>
    </ul>
</nav>
</body>
</html>
<script>
    //
    let currentPage = 1;

    function getDrugs(page) {

        let pageSize = 20;

        $.ajax({
            url: 'http://localhost:8082/api/drugs/list-pageable?page=' + page + '&?size=' + pageSize,
            type: 'GET',
            contentType: "application/json",

            success: function (res) {
                const pagination = $('#pagination');

                pagination.append(`<li className="page-item"><a className="page-link" href="#">Previous</a></li>`);

                let totalPages = res.content.totalPages - 2;

                for (let i = 0; i < totalPages; i++) {
                    pagination.append(`<li className="page-item"><a className="page-link" href="#">i + 1</a></li>`)
                }

                pagination.append(`<li className="page-item"><a className="page-link" href="#">Next</a></li>`);
            }
        });
    }

    getDrugs(currentPage);

</script>